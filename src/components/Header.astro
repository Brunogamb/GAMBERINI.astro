---
import { Image } from 'astro:assets';
import logofull from '../assets/img/logoblanco.webp';
import logofullhover from '../assets/img/logohover.webp';
import logoicon from '/public/faviconblanco.png';
import logoiconhover from '/public/faviconblancohover.png';
---

<header>
    <div class="top-bar">
        <h1 class="header-logo">
            <a href="/">
                <Image src={logofull} alt="Logo blanco Gamberini" class="logo-full" loading="eager" />
                <Image src={logofullhover} alt="Logo hover Gamberini" class="logo-full-hover" loading="eager" />
                <Image src={logoicon} alt="Icono Gamberini" class="logo-icon" loading="eager" />
                <Image src={logoiconhover} alt="Icono hover Gamberini" class="logo-icon-hover" loading="eager" />
            </a>
        </h1>

        <div class="right-bar">
            <nav class="top-nav">
                <a href="/contacto" class="contact-link"><i class="fas fa-phone"></i><span class="text">Contacto</span></a>
            </nav>
            <button class="hamburger" aria-label="Abrir menú" aria-expanded="false" aria-controls="mobile-menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </div>

    <nav class="services-nav desktop-menu">
        <ul>
            <li><a href="/sistema-de-protección-contra-incendios">Sistema de protección contra incendios</a></li>
            <span class="dividing-line">|</span>
            <li><a href="/diseño-y-montaje">Diseño y montaje</a></li>
            <span class="dividing-line">|</span>
            <li><a href="/servicio-tecnico">Servicio técnico</a></li>
        </ul>
    </nav>
    
    <nav class="services-nav mobile-menu" id="mobile-menu" aria-hidden="true">
        <ul>
            <li><a href="/sistema-de-protección-contra-incendios"><span class="text">Sistema de protección contra incendios</span></a></li>
            <li><a href="/diseño-y-montaje"><span class="text">Diseño y montaje</span></a></li>
            <li><a href="/servicio-tecnico"><span class="text">Servicio técnico</span></a></li>
        </ul>
    </nav>
</header>

<style>
header {
    position: relative;
    background: linear-gradient(90deg, var(--brand-900) 20%, var(--brand-800) 45%, var(--brand-700) 95%);
    box-shadow: var(--shadow-md);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100px;
    padding: 0 20px;
}

.top-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    max-width: 1200px;
    margin-bottom: 4px;
}

.header-logo {
    height: 26px;
}

.header-logo img {
    height: 100%;
    width: auto;
}

.logo-icon {
    display: none;
}

.logo-full-hover, .logo-icon-hover {
    display: none;
}

.header-logo:hover .logo-full {
    display: none;
}

.header-logo:hover .logo-full-hover {
    display: inline;
}

.top-nav a {
    color: var(--white);
    font-weight: 400;
    font-size: 16px;
    display: flex;
    align-items: center;
    gap: 8px;
}

.right-bar {
    display: flex;
    gap: 20px;
}

.contact-link {
    color: var(--white);
    border: 1px solid rgba(255,255,255,0.4);
    padding: 8px 16px;
    border-radius: var(--radius-md);
    transition: all 0.2s ease;
}

.contact-link:hover {
    background: var(--brand-900);
	border-color: var(--brand-900);
}

.top-nav a:hover {
    color: var(--white);
}

.services-nav {
    display: flex;
    width: 100%;
    max-width: 1200px;
}

.services-nav ul {
    list-style: none;
    display: flex;
    align-items: center;
    margin: 10px 0 4px;   
    gap: 16px;
}

.services-nav a {
    color: rgba(255,255,255,0.8);
    font-weight: 400;
    font-size: 14px;
    display: flex;
    justify-content: center;
    gap: 8px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    text-decoration: none;
    transition: all 0.2s ease;
}

.services-nav a:hover {
    color: var(--accent);
}

.dividing-line { 
    color: rgba(255,255,255,0.4); 
    font-size: 16px; 
    user-select: none;
}

.hamburger {
    display: none;
    margin: auto;
}

.mobile-menu {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    width: 100%;
    background: linear-gradient(90deg, var(--brand-900) 20%, var(--brand-800) 45%, var(--brand-700) 75%);
    z-index: 15000;
    padding: 20px;
    animation: slideDown 0.25s ease forwards;
}

h1.header-logo {
    margin: 0;
    font-size: inherit;
    font-weight: normal;
    line-height: normal;
}

@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@media (max-width: 745px) {
    .top-nav i {
        font-size: 21px;
    }

    .header-logo {
        height: 22px;
    }

    .text{
        display: none;
    }

    .horizontal-divider {
        display: none;
    }

    .hamburger:hover span {
        background: var(--accent);
    }

    .mobile-menu.active {
        display: flex;
    }

    .desktop-menu {
        display: none;
    }

    .hamburger {
        display: flex;
        flex-direction: column;
        justify-content: space-around;
        width: 28px;
        height: 22px;
        background: transparent;
        border: none;
        cursor: pointer;
    }

    .hamburger span {
        width: 28px;
        height: 3px;
        background: var(--white);
        border-radius: var(--radius-xs);
        transition: all 0.3s linear;
        transform-origin: 4px;
    }

    .hamburger.active span:nth-child(1) {
        transform: rotate(45deg);
    }

    .hamburger.active span:nth-child(2) {
        opacity: 0;
        transform: translateX(20px);
    }

    .hamburger.active span:nth-child(3) {
        transform: rotate(-45deg);
    }

    .mobile-menu ul {
        display: flex;
        flex-direction: column;
        gap: 0px;
    }

    .mobile-menu li {
        margin-bottom: 20px;
    }

    .mobile-menu a {
        gap: 20px;
    }

    .mobile-menu .text {
        display: flex;
        font-size: 1.1rem;
        word-break: break-word;
        flex: 1;
    }

    .services-nav {
        padding: 0 20px;
    }

    .services-nav ul {
        align-items: start;
    }

    header {
        min-height: 80px;
        height: 80px;
    }

    .contact-link {
        border: none;
        padding: 0;
    }

    .contact-link:hover {
        background: transparent;
    }
}

@media (max-width: 380px) {
    .logo-full{
        display: none;
    }

    .logo-icon {
        display: flex;
    }

    .header-logo:hover .logo-full-hover{
        display: none;
    }

    .header-logo:hover .logo-icon{
        display: none;
    }

    .header-logo:hover .logo-icon-hover {
        display: inline;
    }

    .header-logo {
        height: 40px;
    }
}
</style>

<script type="module">
    document.addEventListener('DOMContentLoaded', () => {
        const btnHamburger = document.querySelector('.hamburger');
        const mobileMenu = document.querySelector('.mobile-menu');
        const body = document.body;

        if (!btnHamburger || !mobileMenu) return;

        const toggleMenu = () => {
            const expanded = btnHamburger.getAttribute('aria-expanded') === 'true';
            btnHamburger.setAttribute('aria-expanded', !expanded);
            btnHamburger.classList.toggle('active');
            mobileMenu.classList.toggle('active');
            mobileMenu.setAttribute('aria-hidden', expanded);
            body.classList.toggle('menu-open');
        };

        const closeMenu = () => {
            btnHamburger.setAttribute('aria-expanded', 'false');
            btnHamburger.classList.remove('active');
            mobileMenu.classList.remove('active');
            mobileMenu.setAttribute('aria-hidden', 'true');
            body.classList.remove('menu-open');
        };

        btnHamburger.addEventListener('click', toggleMenu);

        document.addEventListener('click', (e) => {
            if (mobileMenu.classList.contains('active') && 
                !mobileMenu.contains(e.target) && 
                !btnHamburger.contains(e.target)) {
                closeMenu();
            }
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && mobileMenu.classList.contains('active')) {
                closeMenu();
            }
        });
    });
</script>